#!/usr/bin/env python
# coding: utf-8
import numpy as np
from scipy.io import netcdf

fname = "ICE.2013.01-08.f07.nc"

rlon = netcdf.netcdf_file(fname).variables["LON"].data.squeeze()
rlat = netcdf.netcdf_file(fname).variables["LAT"].data.squeeze()

# dx_cent = np.diff(rlon, axis=0)
# dy_cent = np.diff(rlat, axis=1)

rlon_corn = .25*(rlon[0:-2, 0: -2] + rlon[1:-1, 0:-2] +
                 rlon[0:-2, 1:-1] + rlon[1:-1, 1:-1])
rlat_corn = .25*(rlat[0:-2, 0: -2] + rlat[1:-1, 0:-2] +
                 rlat[0:-2, 1:-1] + rlat[1:-1, 1:-1])


rlon_corn = np.column_stack((rlon_corn[:, 0], rlon_corn[:, :], rlon_corn[:, -1]))
rlat_corn = np.array((rlat_corn[0, :], rlat_corn[:, :], rlat_corn[-1, :]))

rlon_corn = np.concatenate((2*rlon_corn[0, :] - rlon_corn[1, :], rlon_corn,  2*rlon_corn[-1, :]-rlon_corn[-2, :]), axis=1)
rlat_corn = np.concatenate((2*rlat_corn[:, 0] - rlat_corn[:, 1], rlat_corn,  2*rlat_corn[:, -1]-rlat_corn[:, -2]), axis=0)

rlon_ll = rlon_corn[0:-2, 0:-2]
rlat_ll = rlat_corn[0:-2, 0:-2]
rlon_ul = rlon_corn[0:-2, 1:-1]
rlat_ul = rlat_corn[0:-2, 1:-1]
rlon_lr = rlon_corn[1:-1, 0:-2]
rlat_lr = rlat_corn[1:-1, 0:-2]
rlon_ur = rlon_corn[1:-1, 1:-1]
rlat_ur = rlat_corn[1:-1, 1:-1]

xbounds = np.column_stack((rlon_ul, rlon_ll, rlon_lr, rlon_ur))
ybounds = np.column_stack((rlat_ul, rlat_ll, rlat_lr, rlat_ur))

np.savetxt("MAR_rlon.dat", rlon)
np.savetxt("MAR_rlat.dat", rlat)

np.savetxt("MAR_xbounds.dat", xbounds)
np.savetxt("MAR_ybounds.dat", ybounds)

